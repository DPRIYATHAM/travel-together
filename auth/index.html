<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Auth Demo</title>
        <link
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"
        rel="stylesheet"
        />
        <link
        href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"
        rel="stylesheet"
        />
        <link
        href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.5.0/mdb.min.css"
        rel="stylesheet"
        />
        <script
        type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.5.0/mdb.min.js"
        ></script>
        <link href="./index.css" rel="stylesheet" />
    </head>
    <body class="d-flex justify-content-center p-5">
        <div class="card">
            <div class="card-header">
                <center><h3>Login Form</h3></center>
            </div>
            <form id="loginForm" class="card-body px-5 py-4">
                <center><small><span id="error" style="color: red;"></span></small></center>
                <label class="custom-field">
                    <input id="email" type="email" class="input" required />
                    <span class="placeholder">Email Id</span>
                </label><br />
                <label class="custom-field">
                    <input id="password" type="password" class="input" required />
                    <span class="placeholder">Password</span>
                </label><br /><br/>
                <a href="#"id="forgot">Forgot Password</a>
                <center><button type="submit" class="btn btn-primary">Login</button>
                <button id="signup" class="btn btn-secondary">Sign Up</button>
                </center>
            </form>
        </div>
        <script type="module">
            // Import the functions you need from the SDKs you need
            import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js";
            import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-analytics.js";
            import { getAuth, onAuthStateChanged, signInWithEmailAndPassword , createUserWithEmailAndPassword, sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/10.13/firebase-auth.js";
            // TODO: Add SDKs for Firebase products that you want to use
            // https://firebase.google.com/docs/web/setup#available-libraries
          
            // Your web app's Firebase configuration
            // For Firebase JS SDK v7.20.0 and later, measurementId is optional
            const firebaseConfig = {
              apiKey: "AIzaSyC3W7p7poQA_ozbXNMv-H7Z271TNKku71U",
              authDomain: "fir-tutorial-4138e.firebaseapp.com",
              projectId: "fir-tutorial-4138e",
              storageBucket: "fir-tutorial-4138e.appspot.com",
              messagingSenderId: "900033058358",
              appId: "1:900033058358:web:f858b5d7d11a11351a6a97",
              measurementId: "G-5ELLBJY6Y7"
            };
          
            // Initialize Firebase
            const app = initializeApp(firebaseConfig);
            const analytics = getAnalytics(app);
            const auth=getAuth(app);

            function login()
            {
                const email=document.getElementById("email").value;
                const password=document.getElementById("password").value;
                signInWithEmailAndPassword(auth,email,password)
                .catch((error)=>{
                    document.getElementById("error").innerHTML=error.message;
                });
            }

            document.getElementById("loginForm").addEventListener("submit",(event)=>{
                event.preventDefault();
                login();
            });

            function signup()
            {
                const email=document.getElementById("email").value;
                const password=document.getElementById("password").value;
                createUserWithEmailAndPassword(auth, email, password)
                .catch((error)=>{
                    document.getElementById("error").innerHTML=error.message;
                });
            }


            document.getElementById("signup").addEventListener("click",()=>{
                signup();
            });

            function forgotpass()
            {
                const email=document.getElementById("email").value;
                sendPasswordResetEmail(auth, email)
                .then(()=>{
                    alert("Reset link send to your email id");
                }
                )
                .catch((error)=>{
                    document.getElementById("error").innerHTML=error.message;
                }
                );
            }

            document.getElementById("forgot").addEventListener("click",()=>{
                forgotpass();
            });

            onAuthStateChanged(auth,(user)=>{
               if(user)
               {
                  location.replace("welcome.html");
               }
            })
          </script>
    </body>
</html>